```html
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>FracShr — Trading For Everyone, Anywhere, Everywhere</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="description" content="FracShr is a level-based trading game. Learn trading with interactive tutorials, pro charts (Candles + SMA + RSI), goal-based levels, and Trading Wars. iOS & Android coming soon." />
  <meta name="theme-color" content="#0a0d12" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family:Poppins:wght@800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Fresh Futuristic Palette */
      --bg:#0a0d12;       /* deep carbon */
      --bg2:#0c121a;      /* night blue */
      --panel:#0f1624;    /* panels */
      --card:#0f1726;
      --line:#152640;

      --text:#ecf5ff;
      --muted:#96a8c0;

      --accent1:#2DE2E6;  /* turquoise */
      --accent2:#8A2BE2;  /* electric violet */
      --accent3:#FF4D8D;  /* magenta */
      --accent4:#00FFA3;  /* neon mint */
      --accent5:#FFC857;  /* amber */

      --up:#20e3b2;
      --down:#ff6b88;

      --shadow: 0 18px 60px rgba(0,0,0,.5), inset 0 0 0 1px rgba(255,255,255,.06);
      --vh: 1vh; /* will be set from JS for safe mobile height */
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;scroll-behavior:smooth;background:var(--bg);color:var(--text)}
    body{
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      line-height:1.55;
      background:
        radial-gradient(900px 600px at -10% -20%, #1b2b8a22 0%, transparent 60%),
        radial-gradient(900px 600px at 110% 120%, #2de2e622 0%, transparent 60%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
      overflow-x:hidden;
    }

    /* Background animated sparks + candlesticks */
    .bg-candles{position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.35;mask-image:radial-gradient(ellipse at center,#000 60%,transparent 100%)}
    .candle{
      position:absolute;width:8px;height:24px;border-radius:2px;
      background:linear-gradient(180deg,var(--accent1),var(--accent3));
      box-shadow:0 0 18px rgba(45,226,230,.35);
      opacity:.28;transform:translateY(110vh) scale(.9);
      animation:rise linear forwards;
    }
    .candle::before,.candle::after{content:"";position:absolute;left:50%;transform:translateX(-50%);width:2px;background:rgba(255,255,255,.7);border-radius:1px}
    .candle::before{top:-16px;height:16px}.candle::after{bottom:-16px;height:16px}
    @keyframes rise{0%{transform:translateY(110vh) scale(.9)}100%{transform:translateY(-20vh) scale(1);opacity:0}}

    /* Header / Nav (centered) */
    header{position:sticky;top:0;z-index:40;background:rgba(10,14,26,.7);backdrop-filter:saturate(120%) blur(10px);border-bottom:1px solid rgba(255,255,255,.08)}
    .nav{max-width:1200px;margin:0 auto;padding:12px 18px;display:flex;justify-content:center;align-items:center;gap:14px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:var(--text)}

    /* Futuristic Professional Logo */
    .logo{
      width:56px;height:56px;border-radius:14px;display:grid;place-items:center;
      background:radial-gradient(100% 100% at 30% 30%, #1b2333 0%, #0f1624 60%, #0c121a 100%);
      box-shadow:0 10px 26px rgba(45,226,230,.18), 0 0 0 3px rgba(255,255,255,.06) inset;
      position:relative;overflow:hidden;
    }
    .logo svg{display:block}
    .logo .halo{
      position:absolute;inset:-30%;background:conic-gradient(from 0deg,var(--accent1),var(--accent2),var(--accent3),var(--accent1));
      filter:blur(24px);opacity:.18;animation:spin 18s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}
    .wordmark{font-family:Poppins,sans-serif;font-weight:900;letter-spacing:.6px;font-size:1.5rem;display:flex;gap:6px;align-items:baseline}
    .wordmark span{background:linear-gradient(90deg,#fff,#b7f7ff 60%,#fff);-webkit-background-clip:text;background-clip:text;color:transparent}

    .menu-btn{display:none;background:transparent;border:2px solid rgba(255,255,255,.18);color:var(--text);border-radius:12px;padding:8px 10px;font-weight:800}
    .nav-links{display:flex;gap:14px;align-items:center;flex-wrap:wrap;justify-content:center}
    .nav-links a{color:var(--muted);text-decoration:none;font-weight:700}
    .nav-links a:hover{color:var(--text)}
    .btn{appearance:none;border:none;outline:none;cursor:pointer;padding:12px 18px;border-radius:14px;font-weight:800;letter-spacing:.2px;color:#06111a;background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 10px 20px rgba(138,43,226,.22),0 4px 14px rgba(45,226,230,.22)}
    .btn:hover{transform:translateY(-1px)}
    .btn-outline{background:transparent;color:var(--text);border:2px solid rgba(255,255,255,.16);box-shadow:none}
    .btn-outline:hover{border-color:rgba(255,255,255,.35)}
    .cta-pulse{position:relative}
    .cta-pulse::after{content:"";position:absolute;inset:-8px;border-radius:18px;border:2px solid rgba(45,226,230,.25);animation:pulse 2.2s infinite ease-out}
    @keyframes pulse{0%{transform:scale(1);opacity:.9}70%{transform:scale(1.12);opacity:0}100%{transform:scale(1.12);opacity:0}}

    /* Hero */
    .hero{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:60px 18px 20px;display:grid;gap:22px;justify-items:center;text-align:center}
    .tagline{display:inline-block;padding:8px 14px;border-radius:999px;font-weight:900;font-size:.8rem;color:#07131a;background:linear-gradient(90deg,var(--accent4),var(--accent1));box-shadow:var(--shadow)}
    h1.big{font-family:Poppins,sans-serif;font-weight:900;line-height:1.06;margin:16px 0 10px;font-size:clamp(2rem,4.2vw,3.6rem)}
    h1.big{background:linear-gradient(90deg,#fff,#b7f7ff 60%,#fff);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 10px 40px rgba(138,43,226,.16)}
    .lead{color:var(--muted);max-width:760px}
    .hero-ctas{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}

    /* Ticker */
    .ticker{position:relative;z-index:1;margin:24px auto 0;max-width:1200px;border-top:1px solid rgba(255,255,255,.06);border-bottom:1px solid rgba(255,255,255,.06);background:linear-gradient(0deg,rgba(255,255,255,.03),rgba(0,0,0,.0));overflow:hidden}
    .marquee{display:flex;gap:30px;padding:10px 0;white-space:nowrap;animation:marq 24s linear infinite}
    .chip{padding:6px 10px;border-radius:10px;font-weight:800;font-size:.9rem;background:#0e1525;border:1px solid rgba(255,255,255,.06);color:var(--muted)}
    .chip.up{color:var(--up);border-color:#20e3b233}.chip.down{color:var(--down);border-color:#ff6b8833}
    @keyframes marq{from{transform:translateX(0)}to{transform:translateX(-50%)}}

    /* Sections (centered) */
    section{position:relative;z-index:1;padding:60px 18px}
    .container{max-width:1200px;margin:0 auto;text-align:center}
    .section-title{font-family:Poppins,sans-serif;font-weight:900;font-size:clamp(1.4rem,3vw,2.2rem);margin-bottom:10px}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(3,1fr);justify-items:center}
    @media (max-width: 900px){ .grid{grid-template-columns:1fr} }
    .card{background:linear-gradient(180deg,#0f1726,#0b1422);border:1px solid rgba(255,255,255,.06);border-radius:18px;padding:18px;box-shadow:var(--shadow);max-width:100%}
    .card .icon{width:42px;height:42px;border-radius:12px;display:grid;place-items:center;margin:0 auto 10px;background:linear-gradient(135deg,var(--accent2),var(--accent1));box-shadow:inset 0 0 0 2px rgba(255,255,255,.08),0 10px 26px rgba(45,226,230,.22)}
    ul.checks{list-style:none;padding:0;margin:10px 0 0}
    ul.checks li{margin:8px 0}
    .check{display:inline-flex;align-items:center;gap:8px;font-weight:700;color:#d9f1ff}
    .check i{width:20px;height:20px;border-radius:6px;display:inline-grid;place-items:center;background:linear-gradient(135deg,var(--accent4),var(--accent1));color:#0b0f1a;font-size:14px;font-weight:900}

    /* Demo modal (phone) — fully responsive for mobile heights */
    .demo-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(5,7,18,.76);backdrop-filter:blur(10px);z-index:60;padding:18px}
    .demo-modal.active{display:flex}

    .phone{
      width:min(420px,94vw);
      height:min(780px, calc(var(--vh) * 92));
      border-radius:28px;overflow:hidden;
      background:linear-gradient(180deg,#111b33,#0b1426);
      border:1px solid rgba(255,255,255,.08);
      box-shadow:0 40px 120px rgba(0,0,0,.55),0 0 0 8px rgba(255,255,255,.04) inset;
      position:relative;display:flex;flex-direction:column;
    }
    .notch{position:absolute;top:10px;left:50%;transform:translateX(-50%);width:42%;height:26px;background:#0a0f24;border-radius:14px;box-shadow:inset 0 1px 0 rgba(255,255,255,.08)}
    .demo-head{padding:48px 12px 10px;display:flex;align-items:center;justify-content:space-between;background:linear-gradient(180deg,rgba(138,43,226,.18),transparent 60%);border-bottom:1px solid rgba(255,255,255,.06)}
    .demo-title{font-weight:800;letter-spacing:.2px}
    .demo-close{background:transparent;border:none;color:var(--muted);font-weight:800;cursor:pointer}
    .demo-body{
      padding:10px;display:grid;gap:10px;
      grid-template-rows:auto auto 1fr auto auto;
      min-height:0; /* allow children to shrink */
      overflow:auto; /* graceful scroll on ultra-small screens */
    }
    .asset-card{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center;background:#121f3d;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:12px}
    .asset-name{font-weight:900}
    .asset-price{font-weight:900;font-size:1.1rem;color:var(--up)}

    .statbar{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:420px){ .statbar{grid-template-columns:1fr} }
    .stat{background:#121f3d;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px;font-size:.92rem}

    .chartWrap{display:grid;gap:8px;min-height:0}
    .chartCard{background:#0e1b38;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:8px;min-height:0}
    #priceCanvas,#rsiCanvas{width:100%;display:block}
    #priceCanvas{height:clamp(160px, 34vh, 260px)}
    #rsiCanvas{height:clamp(90px, 18vh, 130px)}
    .legend{display:flex;gap:12px;flex-wrap:wrap;align-items:center;font-size:.85rem;color:var(--muted)}
    @media (max-height:650px){ .legend{display:none} }

    .qty{display:grid;grid-template-columns:1fr auto;gap:8px;background:#121f3d;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:8px;align-items:center}
    .qty input{width:100%;background:transparent;border:none;color:#fff;font-weight:900;font-size:1.1rem;outline:none}
    .trade-controls{display:grid;grid-template-columns:1fr 1fr;gap:8px;align-items:center}
    .btn-buy{background:linear-gradient(90deg,var(--up),var(--accent4));color:#07121f}
    .btn-sell{background:linear-gradient(90deg,#ff8aa6,var(--accent3));color:#07121f}
    .btn-disabled{opacity:.65;pointer-events:none}
    .pnl{font-weight:900}

    .helper{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border:1px dashed rgba(255,255,255,.12);border-radius:14px;padding:10px;font-size:.95rem;color:#d8efff}
    .next-btn{grid-column:1 / -1;width:100%;padding:12px;border-radius:14px;border:2px solid rgba(255,255,255,.12);background:linear-gradient(90deg,var(--accent5),var(--accent3));color:#07121f;font-weight:900;letter-spacing:.3px;cursor:pointer;animation:pop 1.1s infinite ease-in-out;box-shadow:0 12px 26px rgba(255,77,141,.25)}
    .next-btn.hidden{display:none}
    @keyframes pop{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-1px) scale(1.03)}100%{transform:translateY(0) scale(1)}}

    .level-complete{position:absolute;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;background:rgba(6,10,28,.7);backdrop-filter:blur(8px);text-align:center;padding:20px;z-index:5}
    .level-complete.active{display:flex}
    .stars{display:flex;gap:14px;margin-bottom:10px}
    .star{width:48px;height:48px;background:radial-gradient(circle at 30% 30%,#fff,#ffe600 60%,#ff8a00);clip-path:polygon(50% 0%, 61% 35%, 98% 35%, 67% 57%, 79% 91%, 50% 70%, 21% 91%, 33% 57%, 2% 35%, 39% 35%);filter:drop-shadow(0 10px 22px rgba(255,204,0,.45));animation:twinkle 1.2s ease-in-out infinite}
    .star:nth-child(2){animation-delay:.15s;transform:scale(1.05)}.star:nth-child(3){animation-delay:.3s;transform:scale(1.1)}
    @keyframes twinkle{0%{transform:translateY(0) scale(1);opacity:.9}50%{transform:translateY(-3px) scale(1.06);opacity:1}100%{transform:translateY(0) scale(1);opacity:.9}}

    /* Waitlist modal */
    .waitlist-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(5,7,18,.72);backdrop-filter:blur(8px);z-index:70;padding:18px}
    .waitlist-modal.active{display:flex}
    .waitlist-card{width:min(560px,96vw);background:linear-gradient(180deg,#101a33,#0b1426);border:1px solid rgba(255,255,255,.08);border-radius:20px;padding:20px;box-shadow:var(--shadow);text-align:center}
    .waitlist-row{display:grid;grid-template-columns:1fr auto;gap:10px;margin-top:14px}
    .input{width:100%;background:#121f3d;border:1px solid rgba(255,255,255,.1);color:#fff;border-radius:12px;padding:12px;outline:none;font-weight:800}
    .btn-big{padding:14px 18px;border-radius:14px;font-weight:900}
    .close-x{background:transparent;border:none;color:var(--muted);font-weight:900;cursor:pointer;float:right}

    /* Sticky CTA (centered bottom, with close) */
    .sticky-cta{position:fixed;left:50%;transform:translateX(-50%);bottom:20px;z-index:50;display:grid;gap:8px;width:min(560px,92vw);background:linear-gradient(180deg,#101a33,#0b1426);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:12px;box-shadow:var(--shadow);animation:slideUp .5s ease-out}
    .sticky-cta.hidden{display:none}
    .sticky-top{display:flex;align-items:center;justify-content:space-between}
    .sticky-left{display:flex;align-items:center;gap:10px}
    .sticky-close{background:transparent;border:2px solid rgba(255,255,255,.18);color:var(--muted);border-radius:10px;padding:4px 8px;font-weight:900;cursor:pointer}
    @keyframes slideUp{from{transform:translate(-50%,20px);opacity:0}to{transform:translate(-50%,0);opacity:1}}

    /* Reveal on scroll */
    .reveal{opacity:0;transform:translateY(20px)}
    .reveal.visible{opacity:1;transform:translateY(0);transition:opacity .6s ease, transform .6s ease}

    footer{padding:40px 18px;text-align:center;color:var(--muted);border-top:1px solid rgba(255,255,255,.06)}

    /* Mobile nav */
    .menu-btn{display:none}
    @media (max-width:760px){
      .nav{justify-content:space-between}
      .menu-btn{display:block}
      .nav-links{position:fixed;inset:auto 12px 12px 12px;display:none;flex-direction:column;background:linear-gradient(180deg,#101a33,#0b1426);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:12px;z-index:55}
      .nav-links.open{display:flex}
    }
  </style>
</head>
<body>
  <div class="bg-candles" aria-hidden="true" id="bgCandles"></div>

  <header>
    <nav class="nav">
      <a class="brand" href="#" aria-label="FracShr home">
        <div class="logo" aria-hidden="true">
          <div class="halo"></div>
          <!-- Futuristic FS Monogram Logo -->
          <svg width="34" height="34" viewBox="0 0 110 110" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <defs>
              <linearGradient id="gStroke" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="#2DE2E6"/><stop offset=".5" stop-color="#8A2BE2"/><stop offset="1" stop-color="#FF4D8D"/>
              </linearGradient>
              <linearGradient id="gFill" x1="0" y1="0" x2="1" y2="0">
                <stop offset="0" stop-color="#2DE2E6"/><stop offset="1" stop-color="#8A2BE2"/>
              </linearGradient>
            </defs>
            <!-- Hex ring -->
            <path d="M55 6 L96 30 L96 80 L55 104 L14 80 L14 30 Z" fill="none" stroke="url(#gStroke)" stroke-width="6" stroke-linejoin="round"/>
            <!-- Stylized F -->
            <path d="M34 34 H68 M34 54 H58 M34 34 V78" stroke="url(#gStroke)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
            <!-- Stylized S (continuous curve) -->
            <path d="M72 38 C60 30, 48 38, 48 46 C48 54, 76 54, 76 64 C76 74, 60 78, 48 70" fill="none" stroke="url(#gStroke)" stroke-width="6" stroke-linecap="round"/>
            <!-- Up arrow/candle accent -->
            <rect x="50" y="24" width="6" height="16" rx="3" fill="url(#gFill)"/>
            <rect x="50" y="72" width="6" height="14" rx="3" fill="url(#gFill)"/>
          </svg>
        </div>
        <div class="wordmark"><span>Frac</span><span>Shr</span></div>
      </a>

      <button class="menu-btn" id="menuBtn">☰</button>
      <div class="nav-links" id="navLinks">
        <a href="#features">Features</a>
        <a href="#levels">150+ Levels</a>
        <a href="#war">Trading War</a>
        <a href="#challenges">Challenges</a>
        <button class="btn btn-outline" id="playDemoTop">Play Demo</button>
        <button class="btn cta-pulse" id="openWaitlistTop">Register Interest</button>
      </div>
    </nav>
  </header>

  <main>
    <section class="hero">
      <span class="tagline">TRADING FOR EVERYONE, ANYWHERE, EVERYWHERE</span>
      <h1 class="big">Learn. Play. Profit. A Compact Trading Game with Pro Tools.</h1>
      <p class="lead">Guided tutorials, pro-grade charts (Candles + SMA + RSI), goal-based levels, and timed Trading Wars. Designed for clarity and built mobile-first.</p>
      <div class="hero-ctas">
        <button class="btn cta-pulse" id="playDemoHero">Play Guided Demo</button>
        <button class="btn btn-outline" id="openWaitlistHero">Get Early Access (iOS & Android)</button>
      </div>
    </section>

    <div class="ticker" aria-label="sample market ticker">
      <div class="marquee">
        <span class="chip up">FRA +1.1%</span><span class="chip up">AAPL +1.3%</span><span class="chip down">TSLA -0.8%</span>
        <span class="chip up">BTC +2.4%</span><span class="chip up">ETH +1.9%</span><span class="chip up">NVDA +2.2%</span>
        <span class="chip down">AMZN -0.3%</span><span class="chip up">MSFT +1.0%</span>
        <span class="chip up">FRA +1.1%</span><span class="chip up">AAPL +1.3%</span><span class="chip down">TSLA -0.8%</span>
        <span class="chip up">BTC +2.4%</span><span class="chip up">ETH +1.9%</span><span class="chip up">NVDA +2.2%</span>
        <span class="chip down">AMZN -0.3%</span><span class="chip up">MSFT +1.0%</span>
      </div>
    </div>

    <section id="features" class="reveal">
      <div class="container">
        <h2 class="section-title">Everything You Need To Learn Trading—By Playing</h2>
        <p class="muted">Turn complex ideas into bite-sized interactive challenges with real-time visual feedback and coaching.</p>

        <div class="grid" style="margin-top:16px;">
          <div class="card">
            <div class="icon"><svg width="22" height="22" viewBox="0 0 24 24"><path fill="#06111a" d="M3 3h18v2H3V3Zm0 8h12v2H3v-2Zm0 8h18v2H3v-2Z"/></svg></div>
            <h3>Guided Tutorials</h3>
            <p class="muted">Step-by-step missions teach orders, risk, indicators, and strategy—no experience required.</p>
          </div>
          <div class="card">
            <div class="icon" style="background:linear-gradient(135deg,var(--accent2),var(--accent1));"><svg width="22" height="22" viewBox="0 0 24 24"><path fill="#06111a" d="M3 13h4V3H3v10Zm7 8h4V3h-4v18Zm7-4h4V3h-4v14Z"/></svg></div>
            <h3>Pro Charts</h3>
            <p class="muted">Candles with SMA overlays and RSI oscillator. Learn price action with clean, responsive visuals.</p>
          </div>
          <div class="card">
            <div class="icon" style="background:linear-gradient(135deg,var(--accent3),var(--accent5));"><svg width="22" height="22" viewBox="0 0 24 24"><path fill="#06111a" d="m3 13 4-4 4 4 4-4 6 6v4H3v-6Z"/></svg></div>
            <h3>Scenario Levels</h3>
            <p class="muted">Goal-based levels with live P/L. Practice entries, exits, and risk in realistic situations.</p>
          </div>
        </div>

        <div class="grid" style="margin-top:16px;">
          <div class="card">
            <div class="icon" style="background:linear-gradient(135deg,var(--accent4),var(--accent1));"><svg width="22" height="22" viewBox="0 0 24 24"><path fill="#06111a" d="M2 6h8v12H2V6Zm12 0h8v7h-8V6Z"/></svg></div>
            <h3>Trading War</h3>
            <p class="muted">Invite friends for timed profit battles. Same market, same time—most profit wins.</p>
          </div>
          <div class="card">
            <div class="icon" style="background:linear-gradient(135deg,var(--accent1),var(--accent2));"><svg width="22" height="22" viewBox="0 0 24 24"><path fill="#06111a" d="M19 3H5a2 2 0 0 0-2 2v8h2V5h14v14h-8v2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2Z"/></svg></div>
            <h3>Design & Broadcast</h3>
            <p class="muted">Create custom challenges and share with the community. Build, broadcast, compete.</p>
          </div>
          <div class="card">
            <div class="icon" style="background:linear-gradient(135deg,var(--accent5),var(--accent3));"><svg width="22" height="22" viewBox="0 0 24 24"><path fill="#06111a" d="M12 2 2 7l10 5 10-5-10-5Zm0 7L2 4v13h20V4l-10 5Z"/></svg></div>
            <h3>Anywhere, Everywhere</h3>
            <p class="muted">150+ levels, snackable and mobile-first. iOS and Android apps launching soon.</p>
          </div>
        </div>

        <div style="margin-top:16px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center">
          <button class="btn" id="playDemoCard">Try the Demo</button>
          <button class="btn btn-outline" id="openWaitlistCard">Join Waitlist</button>
        </div>
      </div>
    </section>

    <section id="levels" class="reveal">
      <div class="container">
        <h2 class="section-title">150+ Levels: From First Trade To Advanced Strategy</h2>
        <p class="muted">Progress through worlds: Basics, Charts, Risk, Momentum, Breakouts, Options intro, Macro events, and more. Earn stars, unlock tools, and track your performance.</p>

        <div class="grid" style="margin-top:14px;">
          <div class="card">
            <h3>Learn by Doing</h3>
            <ul class="checks">
              <li class="check"><i>✓</i> Market vs Limit Orders</li>
              <li class="check"><i>✓</i> Support & Resistance</li>
              <li class="check"><i>✓</i> Risk/Reward & Position Sizing</li>
            </ul>
          </div>
          <div class="card">
            <h3>Go Deeper</h3>
            <ul class="checks">
              <li class="check"><i>✓</i> Indicators (SMA, RSI)</li>
              <li class="check"><i>✓</i> Trend & Momentum</li>
              <li class="check"><i>✓</i> News & Event Scenarios</li>
            </ul>
          </div>
          <div class="card">
            <h3>Build & Share</h3>
            <ul class="checks">
              <li class="check"><i>✓</i> Create custom levels</li>
              <li class="check"><i>✓</i> Broadcast to others</li>
              <li class="check"><i>✓</i> Host your own Trading Wars</li>
            </ul>
          </div>
        </div>

        <div style="margin-top:16px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center">
          <button class="btn" id="openWaitlistLevels">Get Launch Invite</button>
          <button class="btn btn-outline" id="playDemoLevels">Try the Demo</button>
        </div>
      </div>
    </section>

    <section id="war" class="reveal">
      <div class="container">
        <h2 class="section-title">Trading War: Time-Based Profit Battles</h2>
        <p class="muted">Invite friends or match globally. Everyone starts with the same cash and instruments. After the countdown, trade your way to the top. Most profit wins.</p>
        <div class="card" style="margin-top:16px;max-width:900px;justify-self:center">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
            <div>
              <h3>How it Works</h3>
              <ul class="checks">
                <li class="check"><i>✓</i> Choose timeframe (3–15 mins)</li>
                <li class="check"><i>✓</i> Select instruments</li>
                <li class="check"><i>✓</i> Live leaderboard updates</li>
                <li class="check"><i>✓</i> Instant replay & stats</li>
              </ul>
              <div style="margin-top:12px">
                <button class="btn" id="openWaitlistWar">Challenge Friends (Coming Soon)</button>
              </div>
            </div>
            <div>
              <div class="card" style="background:#121f3d">
                <h4>Sample Leaderboard</h4>
                <div style="margin-top:10px;display:grid;gap:8px">
                  <div style="display:flex;justify-content:space-between"><span>you_vs_world</span><strong style="color:var(--up)">+3.8%</strong></div>
                  <div style="display:flex;justify-content:space-between"><span>chartninja</span><strong style="color:var(--up)">+3.2%</strong></div>
                  <div style="display:flex;justify-content:space-between"><span>dipbuyer</span><strong style="color:var(--down)">-0.9%</strong></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="challenges" class="reveal">
      <div class="container">
        <h2 class="section-title">Design Your Own Challenges</h2>
        <p class="muted">Build scenarios, set goals, choose assets, and broadcast to others. Turn learning into community-driven play.</p>
        <div class="card" style="margin-top:16px;max-width:900px;justify-self:center">
          <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center">
            <button class="btn" id="openWaitlistChallenges">Create & Broadcast (Soon)</button>
            <button class="btn btn-outline" id="playDemoChallenges">Play Demo</button>
          </div>
        </div>
      </div>
    </section>

    <section class="reveal">
      <div class="container" style="max-width:900px">
        <div class="card">
          <h3>Ready to Level Up?</h3>
          <p class="muted">Join the early access list. We’ll notify you when FracShr launches on iOS & Android.</p>
          <div class="waitlist-row" style="justify-content:center">
            <input id="waitlistEmailBottom" class="input" type="email" placeholder="Enter your email" />
            <button class="btn btn-big" id="joinWaitlistBottom">Join Waitlist</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div style="margin-bottom:10px"><span style="font-family:Poppins;font-weight:900;letter-spacing:.3px">FracShr</span> — Trading For Everyone, Anywhere, Everywhere</div>
    <div style="font-size:.9rem">© <span id="year"></span> FracShr. All rights reserved.</div>
  </footer>

  <!-- DEMO GAME MODAL -->
  <div class="demo-modal" id="demoModal" aria-hidden="true" role="dialog" aria-label="FracShr Demo Game">
    <div class="phone" role="document">
      <div class="notch" aria-hidden="true"></div>
      <div class="demo-head">
        <div class="demo-title">FracShr — Demo Level 1</div>
        <button class="demo-close" id="demoClose">Close ✕</button>
      </div>
      <div class="demo-body">
        <div class="asset-card">
          <div>
            <div class="asset-name">FRA • FracShr Index</div>
            <div class="muted" style="font-size:.85rem">Goal: Grow $10,000 to $11,000</div>
          </div>
          <div class="asset-price" id="priceLabel">$100.00</div>
        </div>

        <div class="statbar">
          <div class="stat">
            <div style="display:flex;justify-content:space-between"><span>Cash</span><strong id="cashLabel">$10,000.00</strong></div>
            <div style="display:flex;justify-content:space-between"><span>Holdings</span><strong id="holdingsLabel">0</strong></div>
          </div>
          <div class="stat">
            <div style="display:flex;justify-content:space-between"><span>Portfolio</span><strong id="portfolioLabel">$10,000.00</strong></div>
            <div style="display:flex;justify-content:space-between"><span>P/L</span><strong class="pnl" id="pnlLabel">$0.00</strong></div>
          </div>
        </div>

        <div class="chartWrap">
          <div class="chartCard">
            <canvas id="priceCanvas" width="700" height="400" aria-label="Price chart with candles and SMA"></canvas>
            <div class="legend">
              <span><span class="dot" style="background:var(--up)"></span> Up Candle</span>
              <span><span class="dot" style="background:var(--down)"></span> Down Candle</span>
              <span><span class="dot" style="background:var(--accent5)"></span> SMA(10)</span>
              <span><span class="dot" style="background:var(--accent1)"></span> SMA(20)</span>
            </div>
          </div>
          <div class="chartCard">
            <canvas id="rsiCanvas" width="700" height="180" aria-label="RSI oscillator"></canvas>
            <div class="legend">
              <span><span class="dot" style="background:var(--accent5)"></span> RSI(14)</span>
              <span class="muted">70 / 30 lines</span>
            </div>
          </div>
          <div class="helper" id="helperText">Welcome! We’ll guide you to a quick win. Tap Next to begin.</div>
        </div>

        <div class="qty">
          <input type="number" id="qtyInput" value="100" min="1" step="1" />
          <div style="display:flex;gap:6px">
            <button class="btn btn-outline" id="resetDemo">Reset</button>
          </div>
        </div>

        <div class="trade-controls">
          <button class="btn btn-buy btn-disabled" id="buyBtn">Buy</button>
          <button class="btn btn-sell btn-disabled" id="sellBtn">Sell</button>
          <button class="next-btn" id="nextBtn">Next ▶</button>
        </div>
      </div>

      <div class="level-complete" id="levelComplete">
        <div class="stars" aria-hidden="true"><div class="star"></div><div class="star"></div><div class="star"></div></div>
        <h3 style="font-family:Poppins;font-weight:900;margin:6px 0">Congratulations — Level Completed!</h3>
        <p class="muted" style="margin:4px 0 10px">You reached $11,000. Nicely done.</p>
        <div style="display:flex;gap:8px;flex-wrap:wrap;justify-content:center">
          <button class="btn" id="openWaitlistFromComplete">Register Interest</button>
          <button class="btn btn-outline" id="closeDemoFromComplete">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- WAITLIST MODAL -->
  <div class="waitlist-modal" id="waitlistModal" role="dialog" aria-label="Register your interest">
    <div class="waitlist-card">
      <button class="close-x" id="closeWaitlist">✕</button>
      <h3 class="section-title" style="margin:0 0 8px">Be First In — iOS & Android Launch</h3>
      <p class="muted">Leave your email to get notified at launch and receive exclusive early access.</p>
      <div class="waitlist-row">
        <input id="waitlistEmail" class="input" type="email" placeholder="Enter your email" />
        <button class="btn btn-big" id="joinWaitlist">Register Interest</button>
      </div>
      <div class="muted" style="margin-top:8px;font-size:.9rem">We respect your inbox. No spam, ever.</div>
    </div>
  </div>

  <!-- Sticky CTA with Close -->
  <div class="sticky-cta hidden" id="stickyCTA" aria-live="polite">
    <div class="sticky-top">
      <div class="sticky-left">
        <div style="width:32px;height:32px;border-radius:10px;background:linear-gradient(135deg,var(--accent1),var(--accent2))"></div>
        <div>
          <strong>Don’t miss the launch</strong>
          <div class="muted" style="font-size:.9rem">Join the waitlist for early access</div>
        </div>
      </div>
      <button class="sticky-close" id="closeStickyCTA">✕</button>
    </div>
    <div class="waitlist-row" style="grid-template-columns:1fr auto">
      <input id="waitlistEmailSticky" class="input" type="email" placeholder="Email address" />
      <button class="btn" id="joinWaitlistSticky">Notify Me</button>
    </div>
  </div>

  <script>
    // Safe viewport height for mobile (prevents iOS 100vh issues)
    function setVH(){
      document.documentElement.style.setProperty('--vh', (window.innerHeight * 0.01) + 'px');
    }
    setVH();
    window.addEventListener('resize', setVH);
    window.addEventListener('orientationchange', ()=> setTimeout(setVH, 200));

    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Mobile menu toggle
    const menuBtn = document.getElementById('menuBtn');
    const navLinks = document.getElementById('navLinks');
    menuBtn?.addEventListener('click', ()=> navLinks.classList.toggle('open'));

    // Background candles
    const bgCandles = document.getElementById('bgCandles');
    function spawnCandles(count=30){
      for (let i=0;i<count;i++){
        const d=document.createElement('div');
        d.className='candle';
        d.style.left=(Math.random()*100)+'vw';
        d.style.animationDuration=(8+Math.random()*12)+'s';
        d.style.animationDelay=(Math.random()*6)+'s';
        d.style.opacity=(0.2+Math.random()*0.35).toFixed(2);
        bgCandles.appendChild(d);
      }
    }
    spawnCandles(40);
    setInterval(()=>spawnCandles(3), 3000);

    // Scroll reveal
    const revealEls=document.querySelectorAll('.reveal');
    const io=new IntersectionObserver(entries=>{
      entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target); }});
    },{threshold:.12});
    revealEls.forEach(el=>io.observe(el));

    // Waitlist modal
    const waitlistModal=document.getElementById('waitlistModal');
    function openWaitlist(){ waitlistModal.classList.add('active'); }
    function closeWaitlist(){ waitlistModal.classList.remove('active'); }
    document.getElementById('closeWaitlist').addEventListener('click', closeWaitlist);
    ['openWaitlistTop','openWaitlistHero','openWaitlistCard','openWaitlistLevels','openWaitlistWar','openWaitlistChallenges']
      .forEach(id=> document.getElementById(id)?.addEventListener('click', openWaitlist));
    function captureWaitlist(id){
      const el=document.getElementById(id);
      const email=(el.value||'').trim();
      if(!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){
        el.focus(); el.style.borderColor='var(--accent3)'; setTimeout(()=> el.style.borderColor='rgba(255,255,255,.1)',1500); return;
      }
      try{ localStorage.setItem('fracshr_waitlist', email); }catch(e){}
      alert('Thanks! You’re on the list. We’ll email you when we launch on iOS & Android.');
      el.value=''; closeWaitlist(); hideStickyCTA(true);
    }
    document.getElementById('joinWaitlist').addEventListener('click', ()=> captureWaitlist('waitlistEmail'));
    document.getElementById('joinWaitlistBottom').addEventListener('click', ()=> captureWaitlist('waitlistEmailBottom'));
    document.getElementById('joinWaitlistSticky').addEventListener('click', ()=> captureWaitlist('waitlistEmailSticky'));

    // Sticky CTA with close and persistence
    const stickyCTA=document.getElementById('stickyCTA');
    const closeStickyCTA=document.getElementById('closeStickyCTA');
    function showStickyCTA(){
      if (localStorage.getItem('fracshr_hide_sticky')==='1') return;
      stickyCTA.classList.remove('hidden');
    }
    function hideStickyCTA(persist=false){
      stickyCTA.classList.add('hidden');
      if(persist){ try{ localStorage.setItem('fracshr_hide_sticky','1'); }catch(e){} }
    }
    closeStickyCTA.addEventListener('click', ()=> hideStickyCTA(true));
    setTimeout(showStickyCTA, 15000);

    // DEMO GAME (Responsive + Candles + SMA + RSI)
    const demoModal=document.getElementById('demoModal');
    const playDemoButtons=['playDemoTop','playDemoHero','playDemoCard','playDemoLevels','playDemoChallenges']
      .map(id=>document.getElementById(id)).filter(Boolean);
    playDemoButtons.forEach(btn=> btn.addEventListener('click', openDemo));
    document.getElementById('demoClose').addEventListener('click', closeDemo);
    window.addEventListener('keydown', (e)=> {
      if(e.key==='Escape'){ if(waitlistModal.classList.contains('active')) closeWaitlist(); else if(demoModal.classList.contains('active')) closeDemo(); }
    });
    waitlistModal.addEventListener('click', (e)=> { if(e.target===waitlistModal) closeWaitlist(); });
    demoModal.addEventListener('click', (e)=> { if(e.target===demoModal) closeDemo(); });

    const priceLabel=document.getElementById('priceLabel');
    const cashLabel=document.getElementById('cashLabel');
    const holdingsLabel=document.getElementById('holdingsLabel');
    const portfolioLabel=document.getElementById('portfolioLabel');
    const pnlLabel=document.getElementById('pnlLabel');
    const buyBtn=document.getElementById('buyBtn');
    const sellBtn=document.getElementById('sellBtn');
    const nextBtn=document.getElementById('nextBtn');
    const qtyInput=document.getElementById('qtyInput');
    const helperText=document.getElementById('helperText');
    const resetDemoBtn=document.getElementById('resetDemo');
    const levelComplete=document.getElementById('levelComplete');
    document.getElementById('openWaitlistFromComplete').addEventListener('click', openWaitlist);
    document.getElementById('closeDemoFromComplete').addEventListener('click', closeDemo);

    let demoState=null;
    let guideTimer=null;

    // Chart data and canvases
    const priceCanvas=document.getElementById('priceCanvas');
    const rsiCanvas=document.getElementById('rsiCanvas');
    let pctx, rctx, dpr;
    let bars=[];  // {o,h,l,c}
    const MAX_BARS=60;

    function openDemo(){ demoModal.classList.add('active'); initDemo(); }
    function closeDemo(){ demoModal.classList.remove('active'); if(guideTimer){ clearInterval(guideTimer); guideTimer=null; } }

    resetDemoBtn.addEventListener('click', initDemo);

    function initDemo(){
      if(guideTimer){ clearInterval(guideTimer); guideTimer=null; }
      levelComplete.classList.remove('active');

      demoState={
        step:0,
        price:100.00,
        cash:10000.00,
        holdings:0,
        avgPrice:0,
        realizedPnL:0,
        goal:11000.00
      };
      qtyInput.value=100; qtyInput.disabled=true;
      buyBtn.classList.add('btn-disabled');
      sellBtn.classList.add('btn-disabled');
      nextBtn.classList.remove('hidden'); nextBtn.textContent='Next ▶';
      showHelper("Welcome! We’ll guide you to a quick win. Tap Next to begin.");

      setupCanvases();
      generateInitialBars();
      drawAll();
      updateUI();
    }

    function setupCanvases(){
      dpr=window.devicePixelRatio||1;
      [priceCanvas, rsiCanvas].forEach(cv=>{
        const rect=cv.getBoundingClientRect();
        const w = Math.max(100, rect.width);
        const h = Math.max(60, rect.height);
        cv.width = Math.round(w * dpr);
        cv.height = Math.round(h * dpr);
      });
      pctx=priceCanvas.getContext('2d'); rctx=rsiCanvas.getContext('2d');
      pctx.setTransform(dpr,0,0,dpr,0,0);
      rctx.setTransform(dpr,0,0,dpr,0,0);
    }
    ['resize','orientationchange'].forEach(evt =>
      window.addEventListener(evt, ()=>{ if(demoModal.classList.contains('active')){ setupCanvases(); drawAll(); }})
    );

    function generateInitialBars(){
      bars=[];
      let last=100;
      for(let i=0;i<30;i++){
        const o=last;
        const delta=(Math.random()-.5)*0.5;
        const c=o+delta;
        const h=Math.max(o,c)+Math.random()*0.3;
        const l=Math.min(o,c)-Math.random()*0.3;
        bars.push({o,h,l,c});
        last=c;
      }
      demoState.price = bars[bars.length-1].c;
    }

    // Indicators
    function SMA(closes, period){
      const out=new Array(closes.length).fill(null);
      let sum=0;
      for(let i=0;i<closes.length;i++){
        sum+=closes[i];
        if(i>=period) sum-=closes[i-period];
        if(i>=period-1) out[i]=sum/period;
      }
      return out;
    }
    function RSI(closes, period=14){
      const out=new Array(closes.length).fill(null);
      if (closes.length < period+1) return out;
      let gains=0, losses=0;
      for(let i=1;i<=period;i++){
        const diff=closes[i]-closes[i-1];
        if(diff>=0) gains+=diff; else losses+=-diff;
      }
      let avgGain=gains/period, avgLoss=losses/period;
      out[period]= 100 - (100/(1 + (avgGain/(avgLoss||1e-6))));
      for(let i=period+1;i<closes.length;i++){
        const diff=closes[i]-closes[i-1];
        const gain= diff>0?diff:0;
        const loss= diff<0?-diff:0;
        avgGain = (avgGain*(period-1) + gain)/period;
        avgLoss = (avgLoss*(period-1) + loss)/period;
        const rs = avgGain/(avgLoss||1e-6);
        out[i]= 100 - (100/(1+rs));
      }
      return out;
    }
    function getCloses(){ return bars.map(b=>b.c); }

    function drawAll(){ drawPriceChart(); drawRSIChart(); }

    function drawPriceChart(){
      const ctx=pctx;
      const w=priceCanvas.clientWidth; const h=priceCanvas.clientHeight;
      ctx.clearRect(0,0,w,h);

      // Grid
      ctx.strokeStyle='rgba(255,255,255,.06)'; ctx.lineWidth=1;
      for(let i=0;i<=5;i++){ ctx.beginPath(); ctx.moveTo(0,i*(h/5)); ctx.lineTo(w,i*(h/5)); ctx.stroke(); }

      const PADDING=10;
      const visible=bars.slice(-50);
      const highs=visible.map(b=>b.h), lows=visible.map(b=>b.l);
      const min=Math.min(...lows); const max=Math.max(...highs);
      const range=(max-min)||1;
      const cw=w - PADDING*2;
      const ch=h - PADDING*2;
      const bw = Math.max(2, cw/visible.length - 2);

      // SMA lines
      const closes=visible.map(b=>b.c);
      const sma10=SMA(closes,10), sma20=SMA(closes,20);

      function yFor(v){ return h - PADDING - ((v - min)/range)*ch; }

      // Candles
      visible.forEach((b, i)=>{
        const x = PADDING + i*(cw/visible.length) + 1;
        // Wick
        ctx.strokeStyle='rgba(255,255,255,.35)';
        ctx.beginPath(); ctx.moveTo(x+bw/2, yFor(b.h)); ctx.lineTo(x+bw/2, yFor(b.l)); ctx.stroke();

        // Body
        const up=b.c>=b.o;
        ctx.fillStyle = up ? getComputedStyle(document.documentElement).getPropertyValue('--up').trim() : getComputedStyle(document.documentElement).getPropertyValue('--down').trim();
        const top = yFor(up?b.c:b.o);
        const bottom = yFor(up?b.o:b.c);
        const height=Math.max(1, bottom - top);
        ctx.fillRect(x, top, bw, height);
      });

      // SMA(10)
      ctx.lineWidth=2; ctx.strokeStyle=getComputedStyle(document.documentElement).getPropertyValue('--accent5').trim(); ctx.beginPath();
      sma10.forEach((v,i)=>{
        if(v==null) return;
        const x=PADDING + i*(cw/sma10.length) + bw/2;
        const y=yFor(v);
        if(i===0 || sma10[i-1]==null) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      });
      ctx.stroke();

      // SMA(20)
      ctx.lineWidth=2; ctx.strokeStyle=getComputedStyle(document.documentElement).getPropertyValue('--accent1').trim(); ctx.beginPath();
      sma20.forEach((v,i)=>{
        if(v==null) return;
        const x=PADDING + i*(cw/sma20.length) + bw/2;
        const y=yFor(v);
        if(i===0 || sma20[i-1]==null) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      });
      ctx.stroke();
    }

    function drawRSIChart(){
      const ctx=rctx;
      const w=rsiCanvas.clientWidth; const h=rsiCanvas.clientHeight;
      ctx.clearRect(0,0,w,h);

      // Grid + bands
      ctx.strokeStyle='rgba(255,255,255,.06)'; ctx.lineWidth=1;
      for(let i=0;i<=4;i++){ ctx.beginPath(); ctx.moveTo(0,i*(h/4)); ctx.lineTo(w,i*(h/4)); ctx.stroke(); }

      const closes=getCloses().slice(-50);
      const rsiArr=RSI(closes,14);

      function yForRSI(v){ return h - (v/100)*h; }

      // Overbought/oversold zones
      ctx.fillStyle='rgba(255,77,141,.08)';
      ctx.fillRect(0, 0, w, yForRSI(70));
      ctx.fillStyle='rgba(32,227,178,.08)';
      ctx.fillRect(0, yForRSI(30), w, h - yForRSI(30));

      // 70/50/30 lines
      ctx.strokeStyle='rgba(255,255,255,.25)'; ctx.lineWidth=1;
      [70,50,30].forEach(v=>{
        ctx.beginPath(); ctx.moveTo(0, yForRSI(v)); ctx.lineTo(w, yForRSI(v)); ctx.stroke();
      });

      // RSI line
      ctx.strokeStyle=getComputedStyle(document.documentElement).getPropertyValue('--accent5').trim(); ctx.lineWidth=2; ctx.beginPath();
      rsiArr.forEach((v,i)=>{
        if(v==null) return;
        const x = (i/(rsiArr.length-1)) * (w-10) + 5;
        const y = yForRSI(v);
        if(i===0 || rsiArr[i-1]==null) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      });
      ctx.stroke();
    }

    function addBar(nextClose){
      const last=bars[bars.length-1]||{c:100};
      const o=last.c;
      const c=Number(nextClose.toFixed(2));
      const h=Math.max(o,c)+Math.random()*0.25;
      const l=Math.min(o,c)-Math.random()*0.25;
      bars.push({o,h,l,c});
      if(bars.length>MAX_BARS) bars.shift();
      demoState.price=c;
    }

    function idleWobble(){
      if(guideTimer || demoState?.step>=3) return;
      const last=bars[bars.length-1]?.c||100;
      const next=last + (Math.random()-.5)*0.3;
      addBar(next);
      drawAll();
    }
    setInterval(idleWobble, 1400);

    function updateUI(){
      priceLabel.textContent = fmtMoney(demoState.price);
      cashLabel.textContent = fmtMoney(demoState.cash);
      holdingsLabel.textContent = String(demoState.holdings);
      const portfolio = demoState.cash + demoState.holdings * demoState.price;
      portfolioLabel.textContent = fmtMoney(portfolio);
      const unreal = demoState.holdings>0 ? (demoState.price - demoState.avgPrice)*demoState.holdings : 0;
      const totalPNL = demoState.realizedPnL + unreal;
      pnlLabel.textContent = (totalPNL>=0?'+':'') + fmtMoney(Math.abs(totalPNL));
      pnlLabel.style.color = totalPNL>=0 ? 'var(--up)' : 'var(--down)';
    }
    function fmtMoney(n){ return '$' + n.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ','); }
    function showHelper(t){ helperText.textContent=t; }

    nextBtn.addEventListener('click', ()=>{
      switch(demoState.step){
        case 0:
          demoState.step=1;
          qtyInput.disabled=false; qtyInput.value=100;
          buyBtn.classList.remove('btn-disabled');
          showHelper("Step 1: Set quantity to 100 and tap BUY to open a position.");
          nextBtn.classList.add('hidden');
          break;
        case 2: // after buy
          demoState.step=3;
          showHelper("Step 2: Watch the market move up. Portfolio updates live.");
          nextBtn.classList.add('hidden');
          startGuidedRise();
          break;
        case 4:
          demoState.step=5;
          sellBtn.classList.remove('btn-disabled');
          showHelper("Step 3: Tap SELL to lock in profit and reach the goal.");
          nextBtn.classList.add('hidden');
          break;
      }
    });

    buyBtn.addEventListener('click', ()=>{
      if(buyBtn.classList.contains('btn-disabled')) return;
      const qty=Math.max(1, Math.floor(Number(qtyInput.value)||0));
      const cost=qty * demoState.price;
      if(cost>demoState.cash){ showHelper("Not enough cash. Try a smaller quantity."); return; }
      demoState.cash-=cost; demoState.holdings+=qty; demoState.avgPrice=demoState.price;
      updateUI(); drawAll();
      buyBtn.classList.add('btn-disabled'); qtyInput.disabled=true;
      demoState.step=2;
      showHelper("Great! Position opened. Tap Next to continue.");
      nextBtn.classList.remove('hidden'); nextBtn.textContent='Next ▶';
    });

    function startGuidedRise(){
      const target=111.00;
      const steps=12;
      const interval=1000; // slower for clarity
      let tick=0;
      guideTimer=setInterval(()=>{
        tick++;
        const last=bars[bars.length-1]?.c || 100;
        const remaining=target - last;
        const move = remaining/Math.max(1, (steps - tick + 1)) + (Math.random()*0.05);
        const next= last + Math.max(0.06, move);
        addBar(next);
        drawAll(); updateUI();
        if(tick>=steps || demoState.price>=target){
          clearInterval(guideTimer); guideTimer=null;
          demoState.step=4;
          showHelper("Nice! You’re in profit. Tap Next to proceed.");
          nextBtn.classList.remove('hidden');
        }
      }, interval);
    }

    sellBtn.addEventListener('click', ()=>{
      if(sellBtn.classList.contains('btn-disabled')) return;
      if(demoState.holdings<=0) return;
      const revenue = demoState.holdings * demoState.price;
      const costBasis = demoState.holdings * demoState.avgPrice;
      const pl = revenue - costBasis;
      demoState.cash += revenue;
      demoState.realizedPnL += pl;
      demoState.holdings = 0;
      updateUI();
      if(demoState.cash >= demoState.goal){
        setTimeout(()=> levelComplete.classList.add('active'), 600);
      }else{
        showHelper("Almost there! Try another trade or reset the demo.");
      }
      sellBtn.classList.add('btn-disabled');
    });

    // Keyboard shortcuts (optional): B buy, S sell, N next
    window.addEventListener('keydown', (e)=>{
      if(!demoModal.classList.contains('active')) return;
      if(e.key==='b' || e.key==='B'){ buyBtn.click(); }
      if(e.key==='s' || e.key==='S'){ sellBtn.click(); }
      if(e.key==='n' || e.key==='N'){ nextBtn.click(); }
    });

    // Attach demo openers (redundant safety)
    ['playDemoTop','playDemoHero','playDemoCard','playDemoLevels','playDemoChallenges']
      .forEach(id=> document.getElementById(id)?.addEventListener('click', openDemo));
  </script>
</body>
</html>
```
